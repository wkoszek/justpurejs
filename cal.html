<html>
<head>
<style>
  table.calendar { font-family: "source code pro"; }
  tr.daynames { background-color: lightgray; }
  td.sat,td.sun,th.sat,th.sun { background-color: lightblue; }
  td.mon,td.tue,td.wed,td.thu,td.fri,td.sat,td.sun { width: 25px;} 
  td.active { background-color: orange; }
  td.daycell { text-align: right; }

  td.daycell:hover { background-color: lightgreen; }
  tr.daynames:hover        { background-color: lightgreen; }
  tr.daynames:hover td.sat { background-color: slateblue; }
  tr.daynames:hover td.sun { background-color: slateblue; }
</style>
</head>

<script>
// el_= DOM element after lookup
// cln_= DOM class name
function cal_month_names() {
	return ["January", "February", "March", "April", "May", "June",
		"July", "August", "September", "October", "November", "December" ];
}
function cal_month_index(month_name) {
	return cal_month_names().findIndex(m => m == month_name);
}

function cal_update_header(cal_cell_name, with_date) {
	let cln_month_name = cal_cell_name + "_month_name";
	let cln_year_name = cal_cell_name + "_year_name";
	let el_month_name = document.getElementsByClassName(cln_month_name)[0];
	let el_year_name = document.getElementsByClassName(cln_year_name)[0];
	el_month_name.innerHTML = cal_month_names()[with_date.getMonth()];
	el_year_name.innerHTML = with_date.getFullYear();
}

function cal(cal_cell_name) {
	let cur_date = new Date();

	cal_update_header(cal_cell_name, cur_date);

console.log("cur_date", cur_date);
	let fst_of_month = new Date(cur_date.getFullYear(), cur_date.getMonth());
console.log("fst_of_month", fst_of_month);
console.log("fst_of_month get day: ", fst_of_month.getDay());
	//Sun=0,Mon=1,Tue=2,Wed=3,Thu=4,Fri=5,Sat=6 <- getDay()
	//Mon=0,Tue=1,Wed=2,Thu=3,Fri=4,Sat=5,Sun=6 <- us
	let skip_days_num = fst_of_month.getDay() - 1;
console.log("skip_days_num", skip_days_num);
	let el_days = document.getElementsByClassName(cal_cell_name);
	let day_to_draw = 1;
	for (el_day of el_days) {
		if (skip_days_num > 0) {
			skip_days_num -= 1;
			continue;
		}
console.log("day_to_draw", day_to_draw);
		let idx_date = new Date(cur_date.getFullYear(), cur_date.getMonth(), day_to_draw);
//console.log("idx_date", idx_date);
		el_day.innerHTML = idx_date.getDate();
		if (day_to_draw === cur_date.getDate()) {
			//el_day.setAttribute('class', el_day.getAttribute('class') + " active")
			//el_day.innerHTML = "*" + el_day.innerHTML;
			el_day.className += " active";
		}
		day_to_draw += 1;
		idx_date = null;
	}
}

function cal_move_back_or_forth(cal_cell_name, direction) {
	console.log("move back");
	let cln_month_name = cal_cell_name + "_month_name";
	let cln_year_name = cal_cell_name + "_year_name";
	let el_month_name = document.getElementsByClassName(cln_month_name)[0];
	let el_year_name = document.getElementsByClassName(cln_year_name)[0];

	let month_name = el_month_name.innerHTML;
	let year_num = parseInt(el_year_name.innerHTML);
	let month_num = cal_month_index(month_name);

	let year_num_next = year_num;
	let month_num_next = (month_num + direction);
	if (month_num_next < 0) {
		month_num_next = cal_month_names().length - 1;
		year_num_next -= 1;
	}
	if (month_num_next >= 12) {
		month_num_next = 0;
		year_num_next += 1;
	}

	console.log("==========");
	console.log(month_num);
	console.log(el_year_name);
	console.log(month_num_next);
	console.log(year_num_next);

	el_month_name.innerHTML = cal_month_names()[month_num_next];
	el_year_name.innerHTML = year_num_next;
	
	// XX TODO redraw calendar here!!!
}
function cal_move_back(cln) {
	cal_move_back_or_forth(cln, -1);
}
function cal_move_forward(cln) {
	cal_move_back_or_forth(cln, 1);
}
</script>

<body onload="cal('daycell')">
<table class="calendar" onload="cal()">
 <tr>
   <td>
     <span onclick="cal_move_back('daycell')"><u>&lt;&lt;</u></span>
   </td>
   <td colspan="5" align="center">
     <span class="daycell_month_name"></span>,
     <span class="daycell_year_name"></span>
   </td>
   <td>
     <span onclick="cal_move_forward('daycell')"><u>&gt;&gt;</u></span>
   </td>
 </tr>

 <tr class="daynames">
   <th class="mon">M</th>
   <th class="tue">T</th>
   <th class="wed">W</th>
   <th class="thu">T</th>
   <th class="fri">F</th>
   <th class="sat">S</th>
   <th class="sun">S</th>
 </tr>

 <tr class="daynames">
   <td class="daycell mon"></td>
   <td class="daycell tue"></td>
   <td class="daycell wed"></td>
   <td class="daycell thu"></td>
   <td class="daycell fri"></td>
   <td class="daycell sat"></td>
   <td class="daycell sun"></td>
 </tr>

 <tr class="daynames">
   <td class="daycell mon"></td>
   <td class="daycell tue"></td>
   <td class="daycell wed"></td>
   <td class="daycell thu"></td>
   <td class="daycell fri"></td>
   <td class="daycell sat"></td>
   <td class="daycell sun"></td>
 </tr>

 <tr class="daynames">
   <td class="daycell mon"></td>
   <td class="daycell tue"></td>
   <td class="daycell wed"></td>
   <td class="daycell thu"></td>
   <td class="daycell fri"></td>
   <td class="daycell sat"></td>
   <td class="daycell sun"></td>
 </tr>

 <tr class="daynames">
   <td class="daycell mon"></td>
   <td class="daycell tue"></td>
   <td class="daycell wed"></td>
   <td class="daycell thu"></td>
   <td class="daycell fri"></td>
   <td class="daycell sat"></td>
   <td class="daycell sun"></td>
 </tr>

 <tr class="daynames">
   <td class="daycell mon"></td>
   <td class="daycell tue"></td>
   <td class="daycell wed"></td>
   <td class="daycell thu"></td>
   <td class="daycell fri"></td>
   <td class="daycell sat"></td>
   <td class="daycell sun"></td>
 </tr>
</table>
</span>


</body>
</html>
