<html>
<head>
<style>
  table.calendar { font-family: "source code pro"; }
  tr.daynames { background-color: lightgray; }
  td.sat,td.sun,th.sat,th.sun { background-color: lightblue; }
  td.mon,td.tue,td.wed,td.thu,td.fri,td.sat,td.sun { width: 25px;} 
  td.active { background-color: orange; }
  td.daycell { text-align: right; }

  td.daycell:hover { background-color: lightgreen; }
  tr.daynames:hover        { background-color: lightgreen; }
  tr.daynames:hover td.sat { background-color: slateblue; }
  tr.daynames:hover td.sun { background-color: slateblue; }
</style>
</head>

<script>

// el_= DOM element after lookup
// cln_= DOM class name
function cal_month_names() {
	return ["January", "February", "March", "April", "May", "June",
		"July", "August", "September", "October", "November", "December" ];
}
function cal_month_index(month_name) {
	return cal_month_names().findIndex(m => m == month_name);
}
function cal_hdr_month_el(cal_cell_name) {
	let cln_month_name = cal_cell_name + "_month_name";
	let el_month_name = document.getElementsByClassName(cln_month_name)[0];
	return el_month_name;
}
function cal_hdr_year_el(cal_cell_name) {
	let cln_year_name = cal_cell_name + "_year_name";
	let el_year_name = document.getElementsByClassName(cln_year_name)[0];
	return el_year_name;
}
function cal_update_header(cal_cell_name, with_date) {
	cal_hdr_month_el().innerHTML = cal_month_names()[with_date.getMonth()];
	cal_hdr_year_el().innerHTML = with_date.getFullYear();
}

function cal(cal_cell_name) {
	let el_month = cal_hdr_month_el(cal_cell_name);
	let el_year = cal_hdr_year_el(cal_cell_name);
console.log(el_month);
console.log(el_year);
	var to_date;
	if (el_year.innerHTML === "" || el_month.innerHTML === "") {
console.log('resetting!!');
		tmpd = new Date();
		to_date = new Date(tmpd.getFullYear(), tmpd.getMonth(), 1);
		el_month.innerHTML = cal_month_names()[to_date.getMonth()];
		el_year.innerHTML = to_date.getFullYear();
console.log("to_date", to_date);
	} else {
console.log('using parsed date from html');
console.log(el_year.innerHTML);
console.log(el_month.innerHTML);
		month_num = cal_month_index(el_month.innerHTML);
		to_date = new Date(parseInt(el_year.innerHTML), parseInt(month_num), 1);
console.log("to_date", to_date);
	}
	cal_draw(cal_cell_name, to_date, new Date());
}

function date_yyyymmdd_eq(a, b) {
	return	a.getFullYear() === b.getFullYear() &&
		a.getMonth() === b.getMonth() &&
		a.getDate() === b.getDate();
}

function cal_draw(cal_cell_name, month_date, now_date) {
	//Sun=0,Mon=1,Tue=2,Wed=3,Thu=4,Fri=5,Sat=6 <- getDay()
	//Mon=0,Tue=1,Wed=2,Thu=3,Fri=4,Sat=5,Sun=6 <- us
console.log(month_date);
	let skip_days_num = month_date.getDay() - 1;
	if (skip_days_num < 0) {
		skip_days_num = 6;
	}
console.log("skip_days_num", skip_days_num);
	let el_days = document.getElementsByClassName(cal_cell_name);
	let idx_date = new Date(month_date.getFullYear(), month_date.getMonth(), 1);
console.log("idx_date", idx_date);
	let start_month = idx_date.getMonth();
console.log("start_month", start_month);
	for (el_day of el_days) {
		if (skip_days_num > 0) {
			el_day.innerHTML = "&nbsp;";
			skip_days_num -= 1;
			continue;
		}
		let same_month = idx_date.getMonth() == start_month;
		el_day.innerHTML = (same_month) ? idx_date.getDate() : "&nbsp;";

//console.log("idx_date", idx_date);
//console.log("now_date", now_date);
		console.log(el_day.classList);
		el_day.classList.remove("active");
		if (date_yyyymmdd_eq(idx_date, now_date)) {
			el_day.classList.add("active");
		}
		idx_date.setDate(idx_date.getDate() + 1);
	}
}

function cal_move_back_or_forth(cal_cell_name, direction) {
	console.log("move back");
	let cln_month_name = cal_cell_name + "_month_name";
	let cln_year_name = cal_cell_name + "_year_name";
	let el_month_name = document.getElementsByClassName(cln_month_name)[0];
	let el_year_name = document.getElementsByClassName(cln_year_name)[0];

	let month_name = el_month_name.innerHTML;
	let year_num = parseInt(el_year_name.innerHTML);
	let month_num = cal_month_index(month_name);

	let year_num_next = year_num;
	let month_num_next = (month_num + direction);
	if (month_num_next < 0) {
		month_num_next = cal_month_names().length - 1;
		year_num_next -= 1;
	}
	if (month_num_next >= 12) {
		month_num_next = 0;
		year_num_next += 1;
	}

	console.log("==========");
	console.log(month_num);
	console.log(el_year_name);
	console.log(month_num_next);
	console.log(year_num_next);

	el_month_name.innerHTML = cal_month_names()[month_num_next];
	el_year_name.innerHTML = year_num_next;
}
function cal_move_back(cln) {
	cal_move_back_or_forth(cln, -1);
	cal(cln);
}
function cal_move_forward(cln) {
	cal_move_back_or_forth(cln, 1);
	cal(cln);
}
</script>

<body onload="cal('daycell')">
<table class="calendar" onload="cal()">
 <tr>
   <td>
     <span onclick="cal_move_back('daycell')"><u>&lt;&lt;</u></span>
   </td>
   <td colspan="5" align="center">
     <small>
     <span class="daycell_month_name"></span>,
     <span class="daycell_year_name"></span>
     </small>
   </td>
   <td>
     <span onclick="cal_move_forward('daycell')"><u>&gt;&gt;</u></span>
   </td>
 </tr>

 <tr class="daynames">
   <th class="mon">M</th>
   <th class="tue">T</th>
   <th class="wed">W</th>
   <th class="thu">T</th>
   <th class="fri">F</th>
   <th class="sat">S</th>
   <th class="sun">S</th>
 </tr>

 <tr class="daynames">
   <td class="daycell mon"></td>
   <td class="daycell tue"></td>
   <td class="daycell wed"></td>
   <td class="daycell thu"></td>
   <td class="daycell fri"></td>
   <td class="daycell sat"></td>
   <td class="daycell sun"></td>
 </tr>

 <tr class="daynames">
   <td class="daycell mon"></td>
   <td class="daycell tue"></td>
   <td class="daycell wed"></td>
   <td class="daycell thu"></td>
   <td class="daycell fri"></td>
   <td class="daycell sat"></td>
   <td class="daycell sun"></td>
 </tr>

 <tr class="daynames">
   <td class="daycell mon"></td>
   <td class="daycell tue"></td>
   <td class="daycell wed"></td>
   <td class="daycell thu"></td>
   <td class="daycell fri"></td>
   <td class="daycell sat"></td>
   <td class="daycell sun"></td>
 </tr>

 <tr class="daynames">
   <td class="daycell mon"></td>
   <td class="daycell tue"></td>
   <td class="daycell wed"></td>
   <td class="daycell thu"></td>
   <td class="daycell fri"></td>
   <td class="daycell sat"></td>
   <td class="daycell sun"></td>
 </tr>

 <tr class="daynames">
   <td class="daycell mon"></td>
   <td class="daycell tue"></td>
   <td class="daycell wed"></td>
   <td class="daycell thu"></td>
   <td class="daycell fri"></td>
   <td class="daycell sat"></td>
   <td class="daycell sun"></td>
 </tr>

 <tr class="daynames">
   <td class="daycell mon"></td>
   <td class="daycell tue"></td>
   <td class="daycell wed"></td>
   <td class="daycell thu"></td>
   <td class="daycell fri"></td>
   <td class="daycell sat"></td>
   <td class="daycell sun"></td>
 </tr>
</table>
</span>


</body>
</html>
